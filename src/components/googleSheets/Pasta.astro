---
import PastaIcon from '../icon/PastaIcon.astro';
---

<div id='menuPASTA'>
  <PastaIcon />
</div>

<script is='inline'>
  const pastaContainer = document.getElementById('menuPASTA');

  function generateItemHTML(itemName, itemData) {
    const itemHTML = `
      <div class="item">
        <div class="title">
          <h3>${itemData.Name}</h3>
          <div class="price">$${itemData.Price}</div>
        </div>
        <div>${itemData.OnHand > 0 ? `${itemData.OnHand} are ready to go!` : `Prep time is up to 24hrs`}</div>
        <p>${itemData.Description} <br><i>Nutrition: ${itemData.Nutrition}</i></p>
      </div>
    `;
    return itemHTML;
  }

  fetch(
    `https://opensheet.elk.sh/1WtA0wRGybu9K4c0jRy1lp0d3IUG2u0r0Kf19M985cGQ/PASTA`,
  )
    .then((response) => response.json())
    .then((data) => {
      const anyItemAvailable = Object.values(data).some(
        (item) => item.Available,
      );

      if (!anyItemAvailable) {
        pastaContainer.style.display = 'none';
        return;
      }

      const categoryDiv = document.createElement('div');
      categoryDiv.classList.add('category');

      const categoryHeading = document.createElement('h2');
      categoryHeading.classList.add('title');
      categoryHeading.textContent = 'PASTA';
      categoryDiv.appendChild(categoryHeading);

      Object.entries(data).forEach(([itemName, itemData]) => {
        if (itemData.Available) {
          const itemHTML = generateItemHTML(itemName, itemData);
          categoryDiv.innerHTML += itemHTML;
        }
      });

      pastaContainer.appendChild(categoryDiv);
    })
    .catch((error) => console.error('Error fetching menu data:', error));
</script>
